---
# Feel free to add content and custom Front Matter to this file.
# To modify the layout, see https://jekyllrb.com/docs/themes/#overriding-theme-defaults

layout: single
classes: wide
title: "Set up your first tenant"
permalink: /docs/beforequickstart/setup-tenant
sidebar:
  nav: "docs"
---

# はじめに
本書は、KAMONOHASHIを使用を開始する読者を対象としており、
KAMONOHASHIを手早く使用開始する方法について説明しています。
各項は簡潔に書かれているため、詳細を知りたい場合は[Admin Guide](/docs/admin)を参照して下さい。


# 前提
KAMONOHASHIのインストールが終了していることを前提にしています。
インストールがまだの方は[インストールガイド](/docs/beforequickstart/install)を参照してください。

また、操作を簡便にするため、テナントに紐づけるGitはGitHubを、RegistryはDockerHubを使用することを前提としています。カスタマイズをする場合は[Admin Guide](/docs/admin)を参照して下さい。

# テナント設定
初期状態では、「Sandbox」という名前のテナントが既定で用意されています。
ここでは、Sandboxテナントを用いてKAMONOHASHIのセットアップを進めます。

## テナントの編集
Sandboxテナントの編集は以下のフローで行います。

1. ストレージ情報の新規登録
1. Sandboxテナントの更新

<a name="new_storage"></a>
### ストレージ情報の新規登録

テナントが利用するストレージの情報を登録します。
ストレージの登録には、オブジェクトストレージへ以下の操作を行う権限を持ったユーザのアクセスキーおよびシークレットキーが必要です。

* バケット追加
* 追加したバケットに対するオブジェクトの追加・取得・削除

ストレージ情報の新規登録は、以下のフローで実行できる。
1. 管理権限を持つユーザでログイン
1. [システム管理] → [ストレージ管理]を選択し、ストレージ一覧画面を表示する
1. 画面右上の新規登録ボタンを押下する
1. 画面に下記の情報を入力し、ストレージ情報を登録する。

![ストレージ登録画面(スクショ3-3)](/assets/images/admin_figure10.png)

|項目  |要否  |説明  |
|---|---|---|
|名前  |必須  |KAMONOHASHIに登録する名前。管理者が各登録情報を識別しやすいような、任意の名前を入力する。 |
|サーバ名URL |必須  |minioのURL<br>（例）kamonohashi.ai:9000  |
|アクセスキー |必須  |minioのアクセスキー |
|シークレットキー  |必須  |minioのシークレットキー|
|NFSサーバ |必須  | NFSサーバのホスト名またはIPアドレス |
|NFS共有ルートディレクトリ |必須  | マウントする際の共有ルートディレクトリポイント |

### Sandboxテナントの編集
テナントの編集は、以下のフローで実行できます。

1. 管理権限を持つユーザでログイン
1. [システム管理] → [テナント管理]を選択し、テナント一覧画面を表示する
1. Sandboxテナントを選択する
1. 画面に下記の情報を入力し、Sandboxテナントを更新する。


![テナント作成画面(スクショ3-2)](/assets/images/admin_figure2.png)

|項目  |要否  |説明  |
|---|---|---|
|テナント名  |必須  |テナントを表す識別子を入力する。英数字およびハイフンのみが使用可能。また更新時は変更不可。<br>（例）kamonohashi  |
|表示名  |必須  |画面等への表示名称を入力する。<br>（例）カモノハシ  |
|ストレージ情報  |必須 |上記で登録したストレージを選択する。 |
|Git情報  |必須  |GitHubを選択し、デフォルトに設定する。 |
|Docker Registry情報  |必須  |DockerHubを選択し、デフォルトに設定する。  |

# ユーザ設定
ユーザはKAMONOHASHIの利用者を表し、テナントに関連付けられます。
ここではユーザをSandboxテナントに紐づけます。


## ユーザの追加とテナントへの関連付け

ローカルユーザの場合、KAMONOHASHI内部で認証情報を管理されます。

ユーザの新規作成は、以下のフローで実行できます。

1. 管理権限を持つユーザでログイン
1. [システム管理] → [ユーザ管理]を選択し、ユーザ一覧画面を表示する
1. 画面右上の新規作成ボタンを押下する
1. 画面に下記の情報を入力し、ローカルユーザを新規に追加する。



![ユーザ新規作成画面(スクショ3-5)](/assets/images/admin_figure5.png)

|項目  |要否  |説明  |
|---|---|---|
|ユーザアカウント  |必須  |ユーザ名。システム内で一意である必要がある。英数字およびハイフンのみが使用可能。 |
|パスワード  |必須  |ユーザ認証に用いるパスワード。 |
|パスワード(再入力)  |必須  |パスワードの確認用。上記パスワードと一致している必要がある。 |
|システムロール  |任意  |追加ユーザに付与するシステムロールを選択する。 |
|テナント |必須  |ユーザをSandboxテナントに紐づける。|
|テナントロール  |任意  |上記テナント項目で選択した分のテナントについて、ユーザが所有するテナントロールをそれぞれ選択する。複数可。 |


## ロール付与
ユーザにロールを付与することで、操作可能な機能を制御できます。
一人のユーザには複数のロールを関連付けられます。

ロールは大きく以下の2種類に大別されます。

* システムロール
    * テナントを横断する、システム全体に関連した情報を取り扱うためのロール
    * 既定では全てのシステム管理権限がある「Adminロール」が使用できる
* テナントロール
    * 特定のテナント内に限定された情報を扱うためのロール
    * 所属するテナントごとに、ユーザに付与するテナントロールを指定する
        * 例えば、同一のユーザに対し、AテナントにはManagerロールを付与し、BテナントにはUserロールとResercherロールを付与する、など
    * 既定では以下の3種類のテナントロールが使用できる

|ロール  |説明  |
|---|---|
|User  |データの追加・削除、およびデータセットの作成・変更を行う権限を持つ。  |
|Researcher  |学習の実行、結果の評価を行う権限を持つ。  |
|Manager  |そのテナント内で使用する計算リソースや権限の管理を行う権限を持つ。  |

# ノード設定

## ノードの追加
KAMONOHASHIの管理下に新しくノードを追加します。

ノードの新規登録画面は、以下のフローで表示できます。

1. 管理権限を持つユーザでログイン
1. [システム管理] → [ノード管理]を選択し、ノード一覧画面を表示する
1. 画面右上の新規作成ボタンを押下する
1. 画面に下記の情報を入力し、ノードを新規に追加する

![ノード新規作成画面(スクショ3-6)](/assets/images/admin_figure6.png)


|項目  |要否  |説明  |
|---|---|---|
|名前  |必須  |ノード名。システム内で一意である必要がある。英数字およびハイフンのみが使用可能。 |
|メモ  |任意  |管理用のメモを自由に入力できる。 |
|パーティション |任意  |今回は設定不要。パーティションについての詳細はAdmin Guideを参照。 |
|アクセスレベル |任意  |Publicを選択する。 |
|TensorBoard実行可否 |任意  |ノード上でTensorBoardコンテナの実行を許可するか指定する。 |

# おわりに
本書ではKAMONOHASHIを手早く使用開始できるように、既定テナントであるSandboxを編集しセットアップする方法について説明しました。
これで、KAMONOHASHIを用いた学習をする準備が整いました。

[チュートリアル](/tutorial/)や[ユーザーガイド](/docs/user)を参考にKAMONOHASHIを用いたAI開発を開始しましょう！